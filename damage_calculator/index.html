<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Main Character Damage Calculator</title>
</head>
<body>
  <h1>Main Character Damage Calculator</h1>
  <form>
    <label for="Atk">Attack (Atk):</label>
    <input type="number" id="Atk" value="5000" step="1"><br><br>

    <label for="DmgMultiplier">Damage Multiplier (%):</label>
    <input type="number" id="DmgMultiplier" value="500" step="1"><br><br>

    <label for="Dmg">Damage Bonus (%):</label>
    <input type="number" id="Dmg" value="300" step="1"><br><br>

    <label for="CritDmg">Critical Damage Bonus (%):</label>
    <input type="number" id="CritDmg" value="300" step="1"><br><br>

    <label for="EnemyLv">Enemy Level:</label>
    <input type="number" id="EnemyLv" value="95" step="1"><br><br>

    <label for="DefDown">Defense Down (%):</label>
    <input type="number" id="DefDown" value="0" step="1"><br><br>

    <label>Enemy Type:</label>
    <input type="radio" name="EnemyType" value="100" checked> Weak (100%)<br>
    <input type="radio" name="EnemyType" value="80"> Neutral (80%)<br>
    <input type="radio" name="EnemyType" value="60"> Resist (60%)<br><br>

    <label for="Vulnerability">Vulnerability (%):</label>
    <input type="number" id="Vulnerability" value="50" step="1"><br><br>

    <label for="ToughnessBroken">Toughness Broken:</label>
    <input type="checkbox" id="ToughnessBroken"><br><br>

    <label for="TrueDmg">True Damage Bonus (%):</label>
    <input type="number" id="TrueDmg" value="30" step="1"><br><br>

    <button type="button" onclick="calculateDamage()">Calculate Damage</button>
  </form>

  <p id="result"></p>

  <button onclick="goToSupport()">Go to Support Buffs</button>

  <script>
    function calculateDamage() {
      const Atk = parseFloat(document.getElementById('Atk').value);
      const DmgMultiplier = parseFloat(document.getElementById('DmgMultiplier').value) / 100;
      const Dmg = parseFloat(document.getElementById('Dmg').value) / 100;
      const CritDmg = parseFloat(document.getElementById('CritDmg').value) / 100;
      const EnemyDefenseMultiplier = 100 / ((parseFloat(document.getElementById('EnemyLv').value) + 20) * (1 - parseFloat(document.getElementById('DefDown').value) / 100) + 100);
      const EnemyType = parseFloat(document.querySelector('input[name="EnemyType"]:checked').value) / 100;
      const Vulnerability = 1 + parseFloat(document.getElementById('Vulnerability').value) / 100;
      const Toughness = document.getElementById('ToughnessBroken').checked ? 1 : 0.9;
      const TrueDmg = parseFloat(document.getElementById('TrueDmg').value) / 100;

      // Retrieve support buffs
      const totalDamageBonus = parseFloat(localStorage.getItem('totalDamageBonus')) || 0;
      const totalResPen = parseFloat(localStorage.getItem('totalResPen')) || 0;

      // Calculate damage
      const result = Atk
        * DmgMultiplier
        * (1 + Dmg + totalDamageBonus)
        * (1 + CritDmg)
        * EnemyDefenseMultiplier
        * (EnemyType + totalResPen)
        * (1 + Vulnerability)
        * Toughness
        * (1 + TrueDmg);

      document.getElementById('result').textContent = `Final Damage: ${result.toFixed(2)}`;
    }

    function goToSupport() {
      window.location.href = "support_characters.html";
    }
  </script>
</body>
</html>
